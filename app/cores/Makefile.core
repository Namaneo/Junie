SYM_FILE := $(shell pwd)/symbols.txt
SYMBOLS  := $(shell cat symbols.txt | sed -e 's/\(.*\)/-D \1=$(NAME)_\1 /')

BUILD_FLAGS += platform=emscripten
MAKEFLAGS += --no-print-directory
QUIET := > /dev/null 2>&1

all: $(TARGET)

$(TARGET):
	@echo Building $(TARGET)...
	@CFLAGS="$(SYMBOLS)" CXXFLAGS="$(SYMBOLS)" $(MAKE) -C $(BUILD_DIR) -j 8 $(BUILD_FLAGS) $(QUIET)

clean:
	@$(MAKE) -C $(BUILD_DIR) $(BUILD_FLAGS) platform=$(PLATFORM) clean $(QUIET)
